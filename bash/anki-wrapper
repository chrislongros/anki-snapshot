#!/bin/bash
SCRIPT_DIR="$(dirname "$(readlink -f "$0")")"
REAL_ANKI=""
for p in /usr/bin/anki /usr/local/bin/anki ~/.local/bin/anki ~/ankidev/anki/run; do
    [[ -x "$p" && "$(readlink -f "$p")" != "$(readlink -f "$0")" ]] && REAL_ANKI="$p" && break
done
[[ -z "$REAL_ANKI" ]] && echo "‚ùå Anki not found" && exit 1
if [[ "$REAL_ANKI" == *ankidev* ]]; then
    (cd "$(dirname "$REAL_ANKI")" && "$REAL_ANKI" "$@")
else
    "$REAL_ANKI" "$@"
fi
echo "üì∏ Auto-snapshotting..."
"$SCRIPT_DIR/anki-snapshot" && "$SCRIPT_DIR/anki-diff"
